{% extends "base.html" %}
{% load static %}
{% load i18n %}
{% load account %}

{% block title %}Cambiar Contraseña - SudaPlay{% endblock title %}

{% block content %}
<div class="container">
    <div class="login-card">
        <div class="login-header">
            <img src="{% static 'img/logo.svg' %}" alt="Logo" class="login-card-logo">
            <h1>{% if token_fail %}Enlace Inválido{% else %}Cambiar Contraseña{% endif %}</h1>

            {% if token_fail %}
            {% url 'account_reset_password' as noset_url %}
            <p>El enlace de restablecimiento de contraseña no es válido, posiblemente porque ya se ha utilizado. Por
                favor, solicita un <a href="{{ noset_url }}">nuevo restablecimiento</a>.</p>
            {% else %}
            <p>Por favor, introduce tu nueva contraseña abajo.</p>
            {% endif %}
        </div>

        {% if not token_fail %}
        <form method="POST" action="{{ action_url }}" class="password_reset login-form">
            {% csrf_token %}
            {% for field in form %}
            <div class="form-group">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                <div class="input-wrapper">
                    <i class="fa fa-lock input-icon"></i>
                    {{ field }}
                </div>
                {% if field.errors %}
                <div class="form-error">
                    {% for error in field.errors %}<p>✗ {{ error }}</p>{% endfor %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
            <button type="submit" class="btn-login">Cambiar Contraseña</button>
        </form>
        {% endif %}

        <div class="signup-link">
            <a href="{% url 'login:login' %}">Volver al inicio de sesión</a>
        </div>
    </div>
</div>
{% endblock content %}